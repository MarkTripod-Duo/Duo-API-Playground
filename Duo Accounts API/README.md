# Duo Accounts API

This collection is designed to interact with the Duo Accounts API. The Accounts API allows a Duo parent account administrator to create, manage, and delete Duo child accounts.

### NOTE: Before referring to steps below please see [Postman Collections & Variables](https://github.com/it-jonjon/Duo-API-Playground/blob/main/README.md#prerequisites).

## üöÄ Getting started with this collection

**Step 1:** Login to your Duo Admin Panel as an Owner on the parent account, click **Applications > Protect an Application** and locate the entry for **Accounts API** in the applications list. Click **Protect** to the far-right to configure the application and make note of your integration key, secret key, and API hostname.

**Step 2:** After creating the Accounts API in the Duo Admin Panel, return to Postman and navigate to **Environments > Globals**, and populate the following variables with their corresponding values.
- `accounts_api_ikey`: Accounts API Integration Key
- `accounts_api_skey`: Accounts API Secret Key
- `accounts_api_host`: Accounts API Hostname

You should now be able to use any request within the Duo Accounts API collection.

### Within this collection, you'll find three individual API requests:

1. **Retrieve Accounts**: Retrieves a list of child accounts and returns their Account Name, Account ID, and API Hostname. These values are then stored as an object map in the `duoChildAccounts` global variable.

2. **Create Account**: Creates a new child account beneath the parent. Requires the 'name' parameter. Please see the Params tab to include the name of the account you'd like to create.

3. **Delete Account**: Deletes a child account beneath the parent. Requires the 'account_id' parameter. Please see the Params tab to include the Account ID of the account you'd like to delete. You can run the Retrieve Accounts request to get the Account ID if you don't have it already.

## üí° Collection Note

The "Retrieve Accounts" request is integral to performing other requests in this workspace. This request allows Duo administrators to pull a list of all their child accounts. The returned child account IDs and account names are stored as an object mapping in the `duoChildAccounts` global variable. The `duoChildAccounts` variable is used in various other requests to perform mass operations across a list of Duo child accounts.

These collections include but are not limited to the Accounts API with the Admin API, Duo Onboarding, and others. Each collection can use the `duoChildAccounts` variable to perform actions against a large list of child accounts, making the retrieval of child accounts an integral part of this workspace.

## üîç Variable Reference

Below is a list of variables defined within this collection. Some variables are dynamically generated during API interactions, while others need to be manually configured.

See Using Variables for further insight on variable use in Postman.

| Variable Name | Description | Scope |
|---------------|-------------|-------|
| `accounts_api_ikey` | Your Accounts API Integration Key. This needs to be manually set in the global variables. | Global |
| `accounts_api_skey` | Your Accounts API Secret Key. This needs to be manually set in the global variables. | Global |
| `accounts_api_host` | Your Accounts API Hostname. This needs to be manually set in the global variables. | Global |
| `timestampHeader` | The current date-time in RFC 2822 format, used as the "Date" header in Duo API requests. Set dynamically during the creation of the authorization header. | Global |
| `hmacAuthHeader` | Contains the HMAC-SHA1 signature for Duo API requests, which acts as the HTTP password in Duo's HTTP Basic Authentication. Unique for each request and dynamically generated by the getAuthHeader function. | Global |
| `duoChildAccounts` | Stores an object mapping between account IDs and their respective account and API-host names, providing a reference for pairing these two variables. Dynamically set by the "Retrieve Accounts" request. | Global |
